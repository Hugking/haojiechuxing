<!--pages/home/home.wxml-->
<view class="DrawerPage {{modalName=='viewModal'?'show':''}}">
  <ticket-report-wrapper>
    <view>
      <view class="cu-bar search bg-white" id='getheight1'>
        <button class="cu-avatar round bg-gray icon-my" open-type="getUserInfo" bindgetuserinfo="getuserinfo" wx:if="{{role == ''}}">
        </button>
        <block wx:else>
          <form bindsubmit="formSubmit" report-submit="true">
            <button formType="submit">
              <form bindsubmit="formSubmit" report-submit="true">
                <button formType="submit" bindtap="showModal" data-target="viewModal" class=" cu-avatar round" style='background-image:url({{userInfo.avatar}});position:fixed;top:20rpx;left:10rpx;'></button>
              </form>
            </button>
          </form>
          <!-- <view style='margin-left:-64rpx'></view> -->
        </block>
        <!-- <view class='search-form round'>
        <text class="icon-search"></text>
        <input type="text" placeholder="搜索支持的城市" confirm-type="search"></input>
      </view> -->
        <view class='content'>{{weather}}</view>
        <view class='action' bindtap='now_city'>
          <text>{{city}}</text>
          <text class="icon-locationfill text-blue"></text>
        </view>
      </view>

      <map id="myMap" style="width: 100%; height: {{mapheight}};" subkey='5U7BZ-QDB6X-MDS46-ZWGSA-WXRKZ-SMBVD' longitude="{{longitude}}" latitude="{{latitude}}" scale='14' markers="{{markerfin}}" polyline="{{polyline}}" show-location hidden='{{hidden}}'>
      </map>
      <view claaa='bg-white' style="width: 100%; height: {{mapheight}}" hidden='{{!hidden}}'> </view>
      <view style='position:fixed;bottom:0px;width:100%' id='getheight2'>
        <view class="margin-xs padding-xs bg-white radius shadow-lg">
          <view class='grid col-3 solids-bottom'>
            <view class="padding-sm">
              <view class="flex justify-center text-gray padding-bottom-sm text-xs">出发地</view>
              <picker bindchange="Pickerstart" value="{{indexs}}" range="{{sthotaddr}}">
                <view class="picker">
                  <text class='flex justify-center text-blue  text-bold'>{{indexs?sthotaddr[indexs]:'出发地'}}</text>
                </view>
              </picker>
            </view>
            <view class="padding-sm flex justify-center align-center ">
              <view class='icon-right'>
              </view>
            </view>
            <view class="padding-sm">
              <view class="flex justify-center text-gray padding-bottom-sm text-xs">目的地</view>
              <picker bindchange="Pickerend" value="{{indexe}}" range="{{enhotaddr}}">
                <view class="picker">
                  <text class='flex justify-center text-green  text-bold'>{{indexe?enhotaddr[indexe]:'目的地'}}</text>
                </view>
              </picker>
            </view>
          </view>
          <view class='grid col-3 solids-bottom'>
            <view class="padding-sm">
              <picker mode="date" value="{{date}}" start="{{today?nowdate:''}}" bindchange="DateChange">
                <view class="picker">
                  <text class='flex justify-center text-black text-bold'>{{date}}</text>
                </view>
              </picker>
            </view>
            <view class="padding-sm">
              <text class='flex justify-center text-black text-bold'></text>
            </view>
            <view class="padding-sm">
              <picker mode="time" value="{{time}}" bindchange="TimeChange">
                <view class="picker">
                  <text class='flex justify-center text-black text-bold'>{{time}}</text>
                </view>
              </picker>
            </view>
          </view>
          <view class="flex justify-center padding-top-xl text-xxl" wx:if="{{cost!='-.--'||null}}">
            <text class='text-price text-red'>{{cost}}</text>
            <text class='text-bold text-black text-xl'>/人</text>
          </view>
          <view class='padding-sm '>
            <view class="cu-bar btn-group" wx:if="{{cost=='-.--'||null}}">
              <button class='cu-btn bg-blue shadow-blur round lg ' bindtap='cost'>计算费用</button>
            </view>
            <view class="cu-bar btn-group" wx:if="{{cost!='-.--'||null}}">
              <button class='cu-btn bg-blue shadow-blur round lg' bindtap='preModal' data-target="preModal">预订</button>
            </view>
            <!-- <view class='padding-top-sm padding-left-sm'>
          <text class='text-gray text-xs padding-left'>清除历史</text>
          <text class='text-gray text-xs padding-left'>清除历史</text>
          <text class='text-gray text-xs padding-left'>清除历史</text>
          <text class='text-gray text-xs padding-left'>清除历史</text>
        </view> -->
          </view>
        </view>
      </view>
    </view>
  </ticket-report-wrapper>
  <view class="cu-modal bottom-modal {{modalName=='preModal'?'show':''}}">
    <view class="cu-dialog">
      <view class="cu-bar bg-white">
        <view class='action text-green'></view>
        <view class='action text-blue' bindtap='hideModal'>取消</view>
      </view>
      <view class='padding-xl'>

        <view class='text-sm'>
          <text class='text-grey'>大约{{distance}}公里</text>
        </view>
        <view class="cu-form-group margin-top">
          <view class='title'>乘车人数</view>
          <picker bindchange="Pickerpeonum" value="{{index}}" range="{{peonumarr}}">
            <view class="picker">
              {{indexr?peonumarr[indexr]:'乘车人数'}}
            </view>
          </picker>
        </view>

        <view class="cu-form-group  margin-top">
          <view class="title">备注：</view>
          <textarea data-placeholder="例:赶9：30的火车" maxlength="-1" placeholder-class="placeholder" class="{{desc?'value':''}}" bindinput="desc" show-confirm-bar='true'></textarea>
        </view>

        <view class='action margin-top'>
          <button class='cu-btn bg-blue shadow margin-tb-xs' bindtap="pre_pay" from-type='submit' wx:if="{{indexr!=null}}">去支付</button>
          <button class='cu-btn bg-blue shadow margin-tb-xs' bindtap="pre_pay" from-type='submit' wx:if="{{indexr==null}}" disabled type=''>去支付</button>
        </view>

      </view>
    </view>
  </view>

</view>

<view class="DrawerClose {{modalName=='viewModal'?'show':''}}" bindtap="hideModal">
  <text class="icon-pullright"></text>
</view>

<scroll-view scroll-y class="DrawerWindow {{modalName=='viewModal'?'show':''}} bg-gray">
  <view class='padding-xs margin-lr-xl margin-top-xl  text-center text-grey bg-white radius'>
    <image src='/img/logo.png' class='response' mode='widthFix' style='width:200rpx;'></image>
    <view class='text-xl' bindtap='log'>豪杰出行
      <text class='text-df'>v1.0</text>
    </view>
    <view class='margin-top-sm'>
      <text>By:wkaanig</text>
    </view>
  </view>
  <view class="cu-list menu card-menu margin-top-xl margin-bottom-xl shadow-lg">
    <view class="cu-item arrow solid-top">
      <navigator class='content' url='../order/order_passenger' hover-class='none'>
        <text class='icon-footprint text-green'></text>
        <text class='text-grey'>我的订单</text>
      </navigator>
    </view>
    <view class="cu-item arrow">
      <navigator class='content' url='../menu/modify/modify' hover-class='none'>
        <text class='icon-link text-orange'></text>
        <text class='text-grey'>修改信息</text>
      </navigator>
    </view>
    <view class="cu-item arrow">
      <navigator class='content' url='../menu/help/help' hover-class='none'>
        <text class='icon-questionfill text-pink'></text>
        <text class='text-grey'>帮助中心</text>
      </navigator>
    </view>
    <view class="cu-item arrow">
      <navigator class='content' url='../menu/about/about' hover-class='none'>
        <text class='icon-infofill text-olive'></text>
        <text class='text-grey'>关于我们</text>
      </navigator>
    </view>
    <view class="cu-item arrow">
      <navigator class='content' url='../menu/feedback/feedback' hover-class='none'>
        <text class='icon-infofill text-blue'></text>
        <text class='text-grey'>意见反馈</text>
      </navigator>
    </view>
  </view>
  <view class="padding flex flex-direction">
    <button class='cu-btn bg-red margin-tb-sm lg' bindtap='exit'>退出登录</button>
  </view>
</scroll-view>